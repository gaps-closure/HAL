// An example GAPS HAL configuration file
// Green - Shared Memory
// August, 2021

// List of HAL interfaces (hal.h defines, config.c loads)
devices =
(
  {
   // xdd0: HAL-Application Link
   enabled      = 1;
   id           = "xdd0";
   model        = "sdh_ha_v1";               // HAL Packet format
   comms        = "zmq";                     // Unix IPC socket
   mode_in      = "sub";                     // ZMQ subscriber from APP
   mode_out     = "pub";                     // ZMQ publisher to APP
   addr_in      = "ipc:///tmp/halpubgreen";  // URI for ZMQ pub
   addr_out     = "ipc:///tmp/halsubgreen";  // URI for ZMQ sub
  },
  {
    // HAL-CDG Link
    enabled       = 1;
    id            = "xdd1";
    model         = "sdh_sm_v1";      // packet format (see packetize.c)
    path          = "/dev/pmem0";     // Where HAL puts data
    comms         = "shm";            // Shared Memory IPC
    addr_off_r    = 0x100000;         // SHM-data read address offset
    addr_off_w    = 0;                // SHM-data write address offset
    guard_time_aw = 5000;             // After write min data duration (milliseconds)
    guard_time_bw = 1000;             // Before write guard time (milliseconds)
  }
)

// HAL Routing Maps
maps =
(
  {
    // B1) Green Writes position (t=1) data to Orange
    from_dev = "xdd0";
    from_mux = 1;
    from_sec = 1;
    from_typ = 1;
    to_dev   = "xdd1";
    to_mux   = 1;
    to_sec   = 1;
    to_typ   = 1;
    codec    = "NULL";
  },
  {
    // B2) Green reads position (t=1) data from Orange
    from_dev = "xdd1";
    from_mux = 2;
    from_sec = 2;
    from_typ = 1;
    to_dev   = "xdd0";
    to_mux   = 2;
    to_sec   = 2;
    to_typ   = 1;
    codec    = "NULL";
  },
  {
    // B3) Green reads distance (t=2) data from Green
    from_dev = "xdd1";
    from_mux = 2;
    from_sec = 2;
    from_typ = 2;
    to_dev   = "xdd0";
    to_mux   = 2;
    to_sec   = 2;
    to_typ   = 2;
    codec    = "NULL";
  },
  {
  // C1) Green Writes raw (t=3) data to Orange
    from_dev = "xdd0";
    from_mux = 1;
    from_sec = 1;
    from_typ = 3;
    to_dev   = "xdd1";
    to_mux   = 1;
    to_sec   = 1;
    to_typ   = 3;
    codec    = "NULL";
  },
  {
    // C2) Green reads raw (t=3) data from Orange
    from_dev = "xdd1";
    from_mux = 2;
    from_sec = 3;
    from_typ = 3;
    to_dev   = "xdd0";
    to_mux   = 2;
    to_sec   = 3;
    to_typ   = 3;
    codec    = "NULL";
  },
  {
    // D1) Green Writes big (t=0x01234567) data to Orange
    from_dev = "xdd0";
    from_mux = 1;
    from_sec = 1;
    from_typ = 19088743;
    to_dev   = "xdd1";
    to_mux   = 1;
    to_sec   = 1;
    to_typ   = 19088743;
    codec    = "NULL";
  },
  {
    // E1) Green write HB (t=113) data to Orange
    from_dev = "xdd0";
    from_mux = 1073741935;
    from_sec = 111;
    from_typ = 113;
    to_dev   = "xdd1";
    to_mux   = 1073741935;
    to_sec   = 111;
    to_typ   = 113;
    codec    = "NULL";
  },
  {
    // E1) Green reads HB (t=13) data from Orange
    from_dev = "xdd1";
    from_mux = 3221225484;
    from_sec = 12;
    from_typ = 13;
    to_dev   = "xdd0";
    to_mux   = 3221225484;
    to_sec   = 12;
    to_typ   = 13;
    codec    = "NULL";
  }
)
